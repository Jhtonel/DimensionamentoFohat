<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Proposta Solar - {{cliente_nome}}</title>
<link rel="icon" type="image/svg+xml" href="/img/logo-bg-blue.svg">

<!-- Fontes e Ícones -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>

<!-- ECharts para gráficos interativos -->
<script src="/vendor/echarts.min.js"></script>

<style>
  :root {
    /* Cores Institucionais */
    --primary: #005792;
    --primary-dark: #003d66;
    --primary-light: #e0f2fe;
    --accent: #10B981;
    --accent-dark: #059669;
    
    /* Neutros */
    --bg-body: #F8FAFC;
    --bg-card: #FFFFFF;
    --text-main: #1E293B;
    --text-muted: #64748B;
    --border: #E2E8F0;
    
    /* Status */
    --success: #10B981;
    --warning: #F59E0B;
    --danger: #EF4444;

    /* Espaçamento */
    --container-width: 1200px;
    --header-height: 70px;
    --radius: 16px;
  }

  /* --- Reset & Base --- */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  
  html { scroll-behavior: smooth; }
  
  body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-body);
    color: var(--text-main);
    line-height: 1.6;
    overflow-x: hidden;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Poppins', sans-serif;
    color: var(--primary);
    line-height: 1.2;
  }

  /* --- Layout --- */
  .container {
    max-width: var(--container-width);
    margin: 0 auto;
    padding: 0 20px;
  }

  section {
    padding: 80px 0;
    border-bottom: 1px solid var(--border);
  }

  /* --- Header Fixo --- */
  .navbar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: var(--header-height);
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    z-index: 1000;
    display: flex;
    align-items: center;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
  }

  .navbar-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .logo img { height: 40px; }

  .nav-links {
    display: flex;
    gap: 30px;
  }

  .nav-link {
    text-decoration: none;
    color: var(--text-muted);
    font-weight: 500;
    font-size: 14px;
    transition: color 0.2s;
    cursor: pointer;
  }

  .nav-link:hover, .nav-link.active {
    color: var(--primary);
  }

  .btn-cta {
    background: var(--accent);
    color: white;
    padding: 10px 24px;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  }

  .btn-cta:hover {
    background: var(--accent-dark);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
  }

  /* --- Hero Section --- */
  .hero {
    min-height: 100vh;
    background: radial-gradient(circle at top right, #005792 0%, #020617 100%);
    color: white;
    display: flex;
    align-items: center;
    position: relative;
    overflow: hidden;
    padding-top: var(--header-height);
  }

  .hero::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                      linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    opacity: 0.3;
  }

  .hero-content {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 60px;
    align-items: center;
  }

  .hero-text h1 {
    font-size: 3.5rem;
    color: white;
    margin-bottom: 20px;
    text-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  .hero-text p {
    font-size: 1.25rem;
    color: rgba(255,255,255,0.9);
    margin-bottom: 40px;
    max-width: 600px;
  }

  .hero-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: var(--radius);
    padding: 30px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  }

  .hero-stat {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .hero-stat:last-child { border-bottom: none; }

  /* --- Cards & Grids --- */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
  .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
  .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }

  .card {
    background: var(--bg-card);
    border-radius: var(--radius);
    padding: 30px;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.03);
    border: 1px solid var(--border);
    transition: transform 0.3s, box-shadow 0.3s;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
  }

  .card.highlight {
    background: linear-gradient(145deg, #ffffff 0%, #f0f9ff 100%);
    border-color: var(--primary-light);
  }

  .card.dark {
    background: var(--primary-dark);
    color: white;
    border: none;
  }
  .card.dark h3, .card.dark p { color: white; }

  /* --- Tipografia & Elementos --- */
  .section-title {
    text-align: center;
    margin-bottom: 60px;
  }
  
  .section-title h2 {
    font-size: 2.5rem;
    margin-bottom: 15px;
  }
  
  .section-title p {
    font-size: 1.1rem;
    color: var(--text-muted);
    max-width: 700px;
    margin: 0 auto;
  }

  .stat-big {
    font-size: 3rem;
    font-weight: 800;
    color: var(--primary);
    line-height: 1;
  }

  .stat-label {
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
    font-weight: 600;
  }

  /* --- Charts --- */
  .chart-wrapper {
    width: 100%;
    height: 400px;
    background: white;
    border-radius: var(--radius);
    padding: 20px;
    border: 1px solid var(--border);
  }
  
  .echart { width: 100%; height: 100%; }

  /* --- Tabelas --- */
  .table-responsive {
    overflow-x: auto;
    border-radius: var(--radius);
    border: 1px solid var(--border);
  }

  table { width: 100%; border-collapse: collapse; background: white; }
  
  th, td {
    padding: 16px 24px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }
  
  th {
    background: var(--bg-body);
    font-weight: 600;
    color: var(--text-main);
    font-size: 0.9rem;
    text-transform: uppercase;
  }

  tr:last-child td { border-bottom: none; }

  /* --- Timeline --- */
  .timeline {
    position: relative;
    max-width: 800px;
    margin: 0 auto;
  }

  .timeline-item {
    padding: 20px 30px;
    background: white;
    border-radius: var(--radius);
    border: 1px solid var(--border);
    margin-bottom: 20px;
    position: relative;
    margin-left: 50px;
  }

  .timeline-item::before {
    content: '';
    position: absolute;
    left: -50px; top: 0; bottom: -20px;
    width: 2px;
    background: var(--border);
  }
  
  .timeline-item::after {
    content: '';
    position: absolute;
    left: -59px; top: 30px;
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--primary);
    border: 4px solid white;
    box-shadow: 0 0 0 2px var(--primary-light);
  }

  .timeline-item:last-child::before { display: none; }

  /* --- Footer --- */
  footer {
    background: var(--text-main);
    color: white;
    padding: 60px 0 30px;
    text-align: center;
  }

  /* --- Responsividade --- */
  @media (max-width: 900px) {
    .hero-content { grid-template-columns: 1fr; text-align: center; }
    .hero-text { margin-bottom: 40px; }
    .hero-text p { margin: 0 auto 30px; }
    .hero-text h1 { font-size: 2.5rem; }
    
    .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
    
    .nav-links { display: none; } /* Simplificação para mobile */
    .btn-cta { font-size: 14px; padding: 8px 16px; }
  }
</style>
</head>
<body>

  <!-- Header -->
  <nav class="navbar">
    <div class="container navbar-content">
      <div class="logo">
        <img src="/img/logo-bg-blue.svg" alt="Fohat Energia">
      </div>
      <div class="nav-links">
        <a href="#problema" class="nav-link">O Problema</a>
        <a href="#solucao" class="nav-link">Solução</a>
        <a href="#economia" class="nav-link">Economia</a>
        <a href="#equipamentos" class="nav-link">Equipamentos</a>
        <a href="#investimento" class="nav-link">Investimento</a>
      </div>
      <a href="#investimento" class="btn-cta">Aceitar Proposta</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container hero-content">
      <div class="hero-text">
        <p style="color: var(--accent); font-weight: 700; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px;">Proposta Personalizada</p>
        <h1>Energia Solar para<br>{{cliente_nome_curto}}</h1>
        <p>Transforme seu telhado em uma usina de energia limpa e economize até 95% na sua conta de luz imediatamente.</p>
        
        <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
          <a href="#investimento" class="btn-cta" style="font-size: 1.1rem; padding: 15px 40px;">Ver Investimento</a>
          <div style="display: flex; align-items: center; gap: 10px;">
            <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i data-lucide="check" color="#10B981"></i>
            </div>
            <span>Garantia de 25 Anos</span>
          </div>
        </div>
      </div>

      <div class="hero-card">
        <div class="hero-stat">
          <span style="opacity: 0.8;">Potência do Sistema</span>
          <strong style="font-size: 1.5rem;">{{potencia_sistema_kwp}} kWp</strong>
        </div>
        <div class="hero-stat">
          <span style="opacity: 0.8;">Geração Mensal Est.</span>
          <strong style="font-size: 1.5rem;">{{geracao_media_mensal}} kWh</strong>
        </div>
        <div class="hero-stat">
          <span style="opacity: 0.8;">Economia Anual</span>
          <strong style="font-size: 1.5rem; color: var(--accent);">{{economia_ano_1}}</strong>
        </div>
        <div class="hero-stat">
          <span style="opacity: 0.8;">Economia 25 Anos</span>
          <strong style="font-size: 1.5rem; color: var(--accent);">{{economia_total_25_anos}}</strong>
        </div>
      </div>
    </div>
  </section>

  <!-- O Problema -->
  <section id="problema">
    <div class="container">
      <div class="section-title">
        <h2>Por que investir agora?</h2>
        <p>A inflação energética corrói seu patrimônio. Veja a projeção dos seus gastos se você não fizer nada.</p>
      </div>

      <div class="grid-2">
        <div class="card">
          <h3>Custo do "Não Fazer Nada"</h3>
          <p style="margin-top: 15px; margin-bottom: 30px;">
            Hoje você paga <strong>{{conta_mensal_media}}</strong> por mês. Com a inflação média de energia (aprox. 7% a.a.), esse valor vai disparar.
          </p>
          
          <div class="chart-wrapper">
            <div id="grafico-slide-03" class="echart"></div>
          </div>
        </div>

        <div class="card highlight">
          <h3>Seu Passivo Financeiro</h3>
          <div style="display: flex; flex-direction: column; gap: 30px; margin-top: 30px;">
            <div>
              <span class="stat-label">Gasto nos próximos 25 anos</span>
              <div class="stat-big" style="color: var(--danger);">{{gasto_total_25_anos}}</div>
              <p style="font-size: 0.9rem; color: var(--text-muted);">Dinheiro "jogado fora" com contas de luz.</p>
            </div>
            
            <hr style="border: 0; border-top: 1px solid var(--border);">
            
            <div>
              <span class="stat-label">Valor que poderia ser investido</span>
              <p>Ao instalar energia solar, você transforma esse custo fixo em patrimônio e investimento rentável.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Solução -->
  <section id="solucao" style="background: white;">
    <div class="container">
      <div class="grid-2" style="align-items: center;">
        <div>
          <span style="color: var(--primary); font-weight: 700;">TECNOLOGIA FOTOVOLTAICA</span>
          <h2 style="margin: 10px 0 30px; font-size: 2.5rem;">Como funciona sua usina</h2>
          
          <div style="display: flex; flex-direction: column; gap: 20px;">
            <div class="card" style="padding: 20px; display: flex; gap: 20px; align-items: start;">
              <div style="background: var(--primary-light); padding: 10px; border-radius: 10px; color: var(--primary);">
                <i data-lucide="sun"></i>
              </div>
              <div>
                <h4>1. Captação</h4>
                <p style="font-size: 0.9rem;">Os painéis solares no seu telhado convertem a luz do sol em energia elétrica contínua.</p>
              </div>
            </div>

            <div class="card" style="padding: 20px; display: flex; gap: 20px; align-items: start;">
              <div style="background: var(--primary-light); padding: 10px; border-radius: 10px; color: var(--primary);">
                <i data-lucide="zap"></i>
              </div>
              <div>
                <h4>2. Conversão</h4>
                <p style="font-size: 0.9rem;">O inversor transforma essa energia para o padrão da sua casa (110/220V), pronta para uso.</p>
              </div>
            </div>

            <div class="card" style="padding: 20px; display: flex; gap: 20px; align-items: start;">
              <div style="background: var(--primary-light); padding: 10px; border-radius: 10px; color: var(--primary);">
                <i data-lucide="refresh-cw"></i>
              </div>
              <div>
                <h4>3. Compensação</h4>
                <p style="font-size: 0.9rem;">A energia que sobra vai para a rede e vira créditos. À noite, você usa esses créditos automaticamente.</p>
              </div>
            </div>
          </div>
        </div>
        
        <div style="text-align: center;">
          <img src="/img/como-funciona.png" alt="Como funciona energia solar" style="max-width: 100%; height: auto;">
        </div>
      </div>
    </div>
  </section>

  <!-- Economia e Payback -->
  <section id="economia">
    <div class="container">
      <div class="section-title">
        <h2>Retorno do Investimento</h2>
        <p>Energia solar não é gasto, é um investimento com retorno superior à renda fixa.</p>
      </div>

      <div class="grid-3">
        <div class="card">
          <span class="stat-label">Payback Estimado</span>
          <div class="stat-big" style="color: var(--accent);">{{anos_payback}} Anos</div>
          <p style="margin-top: 10px; font-size: 0.9rem;">Tempo para o sistema "se pagar" com a própria economia.</p>
        </div>
        
        <div class="card">
          <span class="stat-label">Economia Mensal</span>
          <div class="stat-big">{{economia_mensal}}</div>
          <p style="margin-top: 10px; font-size: 0.9rem;">Redução média estimada na sua fatura.</p>
        </div>

        <div class="card">
          <span class="stat-label">Rentabilidade</span>
          <div class="stat-big">{{payback_meses}}% a.m.</div>
          <p style="margin-top: 10px; font-size: 0.9rem;">Retorno médio sobre o capital investido.</p>
        </div>
      </div>

      <div class="card" style="margin-top: 40px;">
        <h3>Fluxo de Caixa Acumulado</h3>
        <p style="margin-bottom: 20px; color: var(--text-muted);">Veja como seu patrimônio cresce ao deixar de pagar conta de luz.</p>
        <div class="chart-wrapper">
          <div id="grafico-slide-06" class="echart"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Equipamentos -->
  <section id="equipamentos" style="background: white;">
    <div class="container">
      <div class="section-title">
        <h2>Seu Kit Gerador</h2>
        <p>Equipamentos Tier 1 (Primeira Linha) com as melhores garantias do mercado.</p>
      </div>

      <div class="grid-2">
        <div class="card highlight">
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <h3>Módulos Fotovoltaicos</h3>
            <span class="stat-label" style="background: var(--primary); color: white; padding: 5px 10px; border-radius: 4px;">{{quantidade_placas}} Unidades</span>
          </div>
          
          <div style="margin-top: 30px; display: grid; gap: 20px;">
            <div>
              <span class="stat-label">Marca / Modelo</span>
              <p style="font-weight: 600; font-size: 1.1rem;">{{modulo_marca}}</p>
              <p>{{modulo_modelo}}</p>
            </div>
            <div>
              <span class="stat-label">Potência Individual</span>
              <p style="font-weight: 600;">{{potencia_placa_w}} W</p>
            </div>
            <div style="background: white; padding: 15px; border-radius: 10px; border: 1px solid var(--border);">
              <span style="color: var(--accent); font-weight: 700;">Garantia de 25 Anos</span>
              <p style="font-size: 0.9rem;">Performance linear garantida (80% da eficiência)</p>
            </div>
          </div>
        </div>

        <div class="card highlight">
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <h3>Inversor</h3>
            <span class="stat-label" style="background: var(--primary); color: white; padding: 5px 10px; border-radius: 4px;">{{tipo_inversor}}</span>
          </div>
          
          <div style="margin-top: 30px; display: grid; gap: 20px;">
            <div>
              <span class="stat-label">Marca / Modelo</span>
              <p style="font-weight: 600; font-size: 1.1rem;">{{inversor_marca}}</p>
              <p>{{inversor_modelo}}</p>
            </div>
            <div>
              <span class="stat-label">Potência Total</span>
              <p style="font-weight: 600;">{{potencia_sistema_kwp}} kWp</p>
            </div>
            <div style="background: white; padding: 15px; border-radius: 10px; border: 1px solid var(--border);">
              <span style="color: var(--accent); font-weight: 700;">Garantia de 10 Anos</span>
              <p style="font-size: 0.9rem;">Contra defeitos de fabricação e problemas técnicos.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Investimento -->
  <section id="investimento">
    <div class="container">
      <div class="section-title">
        <h2>Investimento</h2>
        <p>Escolha a melhor forma de começar a economizar.</p>
      </div>

      <div class="grid-2">
        <!-- Pagamento à Vista -->
        <div class="card dark" style="display: flex; flex-direction: column; justify-content: center; text-align: center;">
          <h3 style="margin-bottom: 10px;">Pagamento à Vista</h3>
          <p style="opacity: 0.8;">Melhor condição comercial</p>
          
          <div style="margin: 40px 0;">
            <span style="font-size: 1.2rem; opacity: 0.8; text-decoration: line-through;">De {{custo_total_projeto}}</span>
            <div style="font-size: 3.5rem; font-weight: 800; color: var(--accent);">{{preco_final}}</div>
          </div>
          
          <a href="#" class="btn-cta" style="background: white; color: var(--primary); width: 100%;">Fechar Negócio</a>
        </div>

        <!-- Financiamento -->
        <div class="card">
          <h3>Financiamento</h3>
          <p>Troque a conta de luz pela parcela.</p>
          
          <div style="margin-top: 20px; background: var(--primary-light); padding: 15px; border-radius: 10px; text-align: center;">
            <span class="stat-label">Parcela Sugerida</span>
            <div style="font-size: 2rem; font-weight: 800; color: var(--primary);">{{menor_parcela_financiamento}}</div>
          </div>

          <div style="margin-top: 20px;">
            <p style="font-weight: 600; margin-bottom: 10px;">Opções Disponíveis:</p>
            <!-- A tabela de financiamento é injetada aqui pelo backend, vamos estilizar via CSS global -->
            <div class="payment-table-wrapper">
              {{parcelas_financiamento}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Próximos Passos -->
  <section id="steps" style="background: white;">
    <div class="container">
      <div class="section-title">
        <h2>Cronograma de Execução</h2>
      </div>

      <div class="timeline">
        <div class="timeline-item">
          <h4>1. Fechamento</h4>
          <p>Assinatura digital do contrato e validação das condições de pagamento.</p>
        </div>
        <div class="timeline-item">
          <h4>2. Visita Técnica</h4>
          <p>Nossa engenharia valida as condições do telhado e padrão de entrada.</p>
        </div>
        <div class="timeline-item">
          <h4>3. Projeto e Homologação</h4>
          <p>Elaboramos o projeto e damos entrada na concessionária de energia.</p>
        </div>
        <div class="timeline-item">
          <h4>4. Instalação</h4>
          <p>Agendamento e instalação dos equipamentos no seu imóvel.</p>
        </div>
        <div class="timeline-item">
          <h4>5. Ativação</h4>
          <p>Troca do medidor pela concessionária e início da geração!</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Consultor -->
  <section style="background: var(--bg-body);">
    <div class="container" style="text-align: center;">
      <div class="card" style="max-width: 600px; margin: 0 auto; display: flex; align-items: center; gap: 30px; text-align: left;">
        <div style="width: 100px; height: 100px; background: var(--border); border-radius: 50%; overflow: hidden; flex-shrink: 0;">
          <img src="/img/logo-bg-blue.svg" alt="Consultor" style="width: 100%; height: 100%; object-fit: cover;">
        </div>
        <div>
          <span class="stat-label">Seu Consultor</span>
          <h3>{{vendedor_nome}}</h3>
          <p>{{vendedor_email}}</p>
          <p>{{vendedor_telefone}}</p>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <img src="/img/logo-green.svg" alt="Fohat" style="height: 40px; margin-bottom: 20px; filter: brightness(0) invert(1);">
      <p>&copy; {{data_proposta}} Fohat Energia. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script>
    // Inicializar ícones Lucide
    lucide.createIcons();

    // Scripts dos gráficos injetados pelo backend serão executados automaticamente
    // pois o backend substitui os placeholders {{graficos_scripts}} ou similar,
    // mas na estrutura atual do servidor_proposta.py, ele injeta scripts específicos
    // procurando por IDs específicos.
    
    // O backend Python procura por divs com IDs específicos e injeta o script ECharts logo após.
    // Como mantivemos os IDs (#grafico-slide-03, #grafico-slide-06), deve funcionar.
    
    // Smooth Scroll para links internos
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });

    // Navbar scroll effect
    window.addEventListener('scroll', () => {
      const nav = document.querySelector('.navbar');
      if (window.scrollY > 50) {
        nav.style.boxShadow = '0 4px 6px -1px rgba(0,0,0,0.1)';
      } else {
        nav.style.boxShadow = 'none';
      }
    });
  </script>

  <!-- Injeção de Scripts de Gráficos e Tabelas do Backend -->
  <!-- O backend vai procurar strings específicas para substituição -->
</body>
</html>
